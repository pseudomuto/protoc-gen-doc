plugins {
  id 'maven-publish'
}

publishing {

  publications {
    maven(MavenPublication) {
      groupId = 'com.github.davidjlynn'
      artifactId = rootProject.name
      version = System.getenv("GITHUB_REF_NAME")

      artifact("$projectDir/dist/protoc-gen-doc_windows_amd64/protoc-gen-doc.exe") {
        classifier 'windows-x86_64'
        extension 'exe'
      }
      artifact("$projectDir/dist/protoc-gen-doc_linux_amd64/protoc-gen-doc") {
        classifier 'linux-x86_64'
      }
    }
  }

  repositories {
    maven {
      name = "OSSRH"
      url = "https://oss.sonatype.org/service/local/staging/deploy/maven2/"
      credentials {
        username = System.getenv("MAVEN_USERNAME")
        password = System.getenv("MAVEN_PASSWORD")
      }
    }
  }
}
